<p>header-phone works!</p>
<div class="flex items-center md:hidden">
  <button (click)="toggleDropdown()" type="button" class="inline-flex items-center p-2 w-10 h-10 justify-center text-sm text-gray-500 rounded-lg focus:outline-none">
    <span class="sr-only">Open main menu</span>
    <svg class="w-5 h-5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 17 14">
      <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M1 1h15M1 7h15M1 13h15"/>
    </svg>
  </button>
</div>

@if (isDropdownOpen()) {
  <div (click)="toggleDropdown()" class="fixed inset-0 bg-transparent z-20 md:hidden"></div>
}

<div 
  class="fixed top-0 right-0 h-full w-72 bg-black p-5 z-30 transition-transform duration-300 ease-in-out md:hidden flex flex-col"
  [ngClass]="{
    'translate-x-0': isDropdownOpen(),
    'translate-x-full': !isDropdownOpen()
  }"
>
  <div class="overflow-y-auto">
    <ul class="flex flex-col space-y-6 text-white">
      <li class="flex justify-end mb-4">
        <button (click)="toggleDropdown()" class="p-2">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
        </button>
      </li>
      <li>
        <button (click)="selectCategory(null)" class="w-full text-left">Todos los Productos</button>
      </li>
      @for (category of categories; track category) {
        <li>
          <a href="#" (click)="selectCategory(category); $event.preventDefault()">{{ category | titlecase }}</a>
        </li>
      }
      <li class="pt-4 mb-4 border-t border-gray-700">
        <app-search />
      </li>
    </ul>
  </div>

  <div class="flex-shrink-0 pt-4 border-t border-gray-700 text-white">
    <h3 class="text-lg font-semibold mb-3">Carrito</h3>
    @if(cartState.count() > 0) {
      <div class="space-y-3 mb-4 max-h-48 overflow-y-auto">
        @for(item of cartState.products(); track item.product.id) {
          <div class="flex justify-between items-center text-sm">
            <span class="truncate pr-2">{{ item.product.title }} (x{{ item.quantity }})</span>
            <span class="font-medium whitespace-nowrap">{{ (item.product.price * item.quantity) | currency }}</span>
          </div>
        }
      </div>
      <div class="space-y-3">
        <div class="flex justify-between font-bold text-base border-t border-gray-600 pt-2">
          <span>Total</span>
          <span>{{ cartState.price() | currency }}</span>
        </div>
        <button (click)="goToCart()" class="w-full text-center bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-lg">
          Proceder al Carrito
        </button>
      </div>
    } @else {
      <p class="text-sm text-gray-400">Tu carrito está vacío.</p>
    }
  </div>
</div>